<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/artista.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <title>Artita</title>
</head>

<body>
    <header>
        <nav>
            <h2>El universo musical</h2>
            <a href="index.html">Home</a>
            <a href="sobreNosotros.html">About us</a>

            <a href="busqueda.html">Busqueda</a>
            <a href="log_in.html">log in</a>
        </nav>
    </header>
    <div>
        <h2 id="nombre">Yeah Yeah Yeahs</h2>
        <section class="row center">
            <img id="foto">
            <div id="info">
                <p id="nombre-real"></p>
                <p id="anio"></p>
                <p id="oyentes"></p>
            </div>
        </section>

        <h3>Biografía</h3>
        <p>Yeah Yeah Yeahs are an American indie rock band formed in New York City in 2000. The group is composed of
            vocalist and pianist Karen O (born Karen Lee Orzolek), guitarist and keyboardist Nick Zinner, and drummer
            Brian Chase.[4] They are complemented in live performances by second guitarist David Pajo (formerly of Slint
            and Tortoise), who joined as a touring member in 2009 and replaced Imaad Wasif, who had previously held the
            role. According to a 2004 interview that aired during their appearance on ABC's Live from Central Park
            SummerStage series, the band's name was taken from modern New York City vernacular.[5] </p>
        <section id="canciones_po">
            <h3>Canciones más populares</h3>
            <ul id="lista-canciones">
            </ul>
        </section>
        <section id="albumes_po">
            <h3>Álbumes más populares</h3>
            <ul id="lista-albums">
            </ul>
        </section>
    </div>
    <footer>
        <div class="footer-content">
            <p>© 2025 El universo musical</p>
            <div class="social-icons">
                <a href="#" target="_blank" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                <a href="#" target="_blank" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                <a href="#" target="_blank" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
                <a href="#" target="_blank" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
            </div>
        </div>
    </footer>
</body>

</html>

<script>

// 1. Obtener el parámetro 'id' de la URL
const params = new URLSearchParams(window.location.search);
const id = params.get('id');

// 2. Verificar si hay ID
if (id) {
  // 3. Hacer la petición GET a la API
  fetch(`/api/artists?id=${id}`)
    .then(response => {
      if (!response.ok) throw new Error('No se pudo obtener el artista');
      return response.json();
    })
    .then(data => {
      const artista = data[0]; // Suponemos que API devuelve un array
      // 4. Mostrar datos en el HTML
      document.getElementById('nombre').textContent = artista.stage_name;
      document.getElementById('foto').src = artista.photo_url;
      document.getElementById('nombre-real').innerHTML = `Nombre real: <strong>${artista.real_name}</strong>`;
      document.getElementById('anio').innerHTML = `Año debut: <strong>${artista.debut_year}</strong>`;
      document.getElementById('oyentes').innerHTML = `Oyentes mensuales: <strong>${artista.monthly_listeners.toLocaleString('es-ES')}</strong>`;
    })
    .catch(err => {
      console.error(err);
      document.body.innerHTML = '<p>Error al cargar el artista.</p>';
    });

    //Info de las canciones
    fetch(`/api/songs?artist_id=${id}`)
    .then(response => {
      if (!response.ok) throw new Error('No se pudieron cargar las canciones');
      return response.json();
    })
    .then(songs => {
      const ul = document.getElementById('lista-canciones');

      if (songs.length === 0) {
        ul.innerHTML = '<li><p>No hay canciones disponibles.</p></li>';
        return;
      }

      songs.sort((a, b) => b.play_count - a.play_count); // ordena por más escuchadas

      songs.forEach(song => {
        const li = document.createElement('li');

        const a = document.createElement('a');
        a.href = `detalle_cancion.html?id=${song.id}`;

        const h3 = document.createElement('h3');
        h3.textContent = song.title;

        a.appendChild(h3);
        li.appendChild(a);
        ul.appendChild(li);
      });
    })
    .catch(err => {
      console.error(err);
      document.getElementById('lista-canciones').innerHTML = '<li><p>Error al cargar canciones.</p></li>';
    });


    //Info de las albumes
    fetch(`/api/albums?artist_id=${id}`)
    .then(response => {
      if (!response.ok) throw new Error('No se pudieron cargar los álbumes');
      return response.json();
    })
    .then(albums => {
      const ul = document.getElementById('lista-albums');

      if (albums.length === 0) {
        ul.innerHTML = '<li><p>No hay álbumes disponibles.</p></li>';
        return;
      }

      albums.forEach(album => {
        const li = document.createElement('li');
        const img = document.createElement('img');
        img.src = album.photo_url;

        const h3 = document.createElement('h3');
        h3.textContent = album.name;

        li.appendChild(img);
        li.appendChild(h3);
        ul.appendChild(li);
      });
    })
    .catch(err => {
      console.error(err);
      document.getElementById('lista-albums').innerHTML = '<li><p>Error al cargar álbumes.</p></li>';
    });
} else {
  document.body.innerHTML = '<p>Parámetro "id" no encontrado en la URL.</p>';
}


</script>